#Proposal to change the svn tree structure of getpaid

= Introduction =

This is a compilation of the emails exchanged between Matt Halstead and Kapil. I (lucielejard) have added some comments too.

The current svn tree structure of getpaid needs changing to help compartmentalize the packages properly.
The structure would look like the packages used in plone (see http://svn.plone.org/svn/plone/ - e.g. http://svn.plone.org/svn/plone/plone.app.content/)

Ideally all the packages currently located in
http://getpaid.googlecode.com/svn/trunk/PACKAGENAME
should be moved to
http://getpaid.googlecode.com/svn/PACKAGENAME/trunk

This would mean we can begin making individual releases of these packages to pypi and follow a more obvious method for people branching and tagging them. It will mean an update to the buildout for development, but not a difficult task.

Once this is done, we can use Tarek's release machinery (see post http://tarekziade.wordpress.com/2008/06/08/eggs-releasing-procedure-and-continuous-integration/)
to make releases of the individual packages to PyPi (it will create the necessary branch and tag for the package in svn and play the setup.cfg game automatically).

Once this is done, we can put together a production buildout example, and perhaps get to packaging PloneGetPaid product as an egg as well.

= Details =

== Potential Problems ==

1)
Problem: There will potentially be major consequences for people who are tracking trunk and not a fixed revision of getpaid and are doing this through their own buildout configurations.

Answer: Very few are running off of trunk for environments other than development; even so, we will need to update documentation (DevGettingStarted, plone.org and also in the PloneGetPaid/docs), the buildouts, and make sure we let everyone know. Also, once we are done moving everything, put a README to say where the code has moved and tell people what to do.

2)
Problem: One problem is that google code has always felt like it was "one project per google code account", which is why it starts off with a svn/trunk layout. We would effectively be saying there are now multiple projects within the same space and possible an array of licenses (though that could be normalized).

Answer: The original structure was chosen because it is much easier to branch and tag the set of packages. If individual packages are being released and pushed out, then switching the structure makes sense. It's easy enough to do, you're not forced into google code's /trunk /branches /tags structure, you can move other things to the the top level and delete the top level structures.

Given that we have buildout, we can probably do the change without causing too much pain for existing checkouts (if we keep the existing layout for buildouts.. )... or not and document and notify. personally i'd prefer if svn up didn't barf because we moved the buildout and invalidated every extant checkout.

3)
Problem:
Regarding the repo, we do need to formalize the contributor policy. Apparently there was some confusion around the license (GetPaid is ZPL, not GPL) and it would be best to keep things consistent imho in the repo. Though if we do get extensive enough that we need a "collective" and "core", then that would allow people to do as they please.

Answer: the getpaid code is BSD (not ZPL, although the two are very similiar ), and i think that all code in the getpaid repository should be the same. It's not meant to be the collective bumper car free for all. If there are add ons that people want to contribute under different licenses, they can host a repo in the collective (or wherever they want) and release it to pypi for distribution. So all the licenses need to be checked too.

4)
Problem: Are you thinking every commit should generate a development egg release on any packages touched? or timed snapshots? I'm not sure moving to development eggs would benefit development. Timed tarball releases of all packages would seem useful though.

Answer:
-1 to dev eggs on pypi .. if you using dev code, use svn. Eggs are much easier to release if its actually warranted.
Dev eggs will be in src and dev products will be in products => normal buildout way
We will only release eggs (and put them on pypi) when there is something to release.

== How to Contribute == 

You need to send you pypi login id to Kapil and he will add you to the maintainers on the getpaid eggs already uploaded (getpaid.core/getpaid.report, see http://pypi.python.org/pypi?%3Aaction=search&term=getpaid&submit=search).

The vendors packages are in the getpaid repo, and have a whole set of issues associated with them relating to using via eggs:
  * hurry.workflow i've basically forked due to lack of upstream response on patches/tests for parallel/adapted workflows and 2.9 compatiblity, its distributed as ore.workflow and works with the existing annotations of hurry.workflow.
  * zc.table relies on zc.resourcelibrary, both of these were basically non functional without some minor mods. 
  * zc.resourcelibrary is basically deadweight, its not usable in z2. however recent versions will pull in a lot of zope3 eggs that will break a plone instance.

Matt Halstead wrote in his email (but we don't have any news from him):

I know I'm volunteering to:
- make the initial changes to the repository structure
- update all the setup.py data to reflect Kapil's suggestions
- write some release script that runs Tarek's release mechanism for
each getpaid package (I can't do this for the non-getpaid packages)

== Implementation Proposition ==

I (lucielejard) might work on that on 8/21-22 if I have the green light.
  * create the new structure on my computer:
     * create a tmp folder
     * put all the sources needed in it, for example:
        * create tmp/getpaid.discount/branches and tmp/getpaid.discount/tags
        * no need to create the trunk yet since we will copy over later
  * once the structure is ready, import it: svn import tmp http://getpaid.googlecode.com/svn/
  * move everything that needs to be moved from http://getpaid.googlecode.com/svn/trunk/PACKAGENAME to http://getpaid.googlecode.com/svn/PACKAGENAME/trunk, for example:
     * mv http://getpaid.googlecode.com/svn/trunk/getpaid.discount/ http://getpaid.googlecode.com/svn/getpaid.discount/trunk
  * update the EXTERNALS files and buildout config files that need to
  * create pypi sources for the eggs that are in getpaid-buildout/src (for the eggs that need it)
  * create a versions.cfg file that has all the versions information for when you want to use getpaid on a production site
 
Extra:
  * eggify getpaid-buildout/develop-products/PloneGetPaid
  * release should be handled by a recipe (down the road)
 